---
title: "GIS & Python Programming"
format:
  html:
    theme: cosmo
    toc: true
    toc-location: right
    toc-depth: 4
    number-sections: false
    page-layout: full
    smooth-scroll: true
---

```{r setup, include=FALSE}
library(ggplot2)
library(tidyverse)
library(gridExtra)
library(scales)

# Personal visual DNA
c1  <- "#18A3A3"      # teal (primary)
c2  <- "#FF4D8D"      # rose pink (accent)
c3  <- "#7A7A7A"      # mid grey
c4  <- "#000000"      # border / text
acc <- "#E65100"      # deep orange (trend / highlight)

theme1 <- function() {
  theme_minimal(base_family = "sans") +
    theme(
      text             = element_text(colour = c4),
      plot.title       = element_text(face = "bold", colour = c4, size = 13,
                                      hjust = 0.5),
      plot.subtitle    = element_text(colour = c3, size = 10, hjust = 0.5),
      axis.title       = element_text(colour = c4, size = 11),
      axis.text        = element_text(colour = c3),
      panel.grid.major = element_line(color = scales::alpha(c3, 0.3),
                                      linetype = "dotted"),
      panel.grid.minor = element_blank(),
      legend.text      = element_text(colour = c4),
      legend.title     = element_text(colour = c4, face = "bold")
    )
}
```

## Assignments / ä½œæ¥­ {#assignments}

### Lab 2 â€” Retirement Calculator / é€€ä¼‘åŸºé‡‘è¨ˆç®—å™¨

**Topic / ä¸»é¡Œï¼š** Financial planning with compound interest calculations
ä»¥è¤‡åˆ©è¨ˆç®—ç‚ºåŸºç¤çš„é€€ä¼‘åŸºé‡‘è¦åŠƒå·¥å…·ã€‚

**Key Concepts / æ ¸å¿ƒæ¦‚å¿µï¼š** Functions, loops, formatted output, compound interest

```{mermaid}
%%{init: {"theme": "base", "themeVariables": {"fontSize": "18px"}, "flowchart": {"padding": 35}}}%%
flowchart LR
    A["User Input     "] --> B["Monthly Contribution     "] --> C["Compound Interest     "] --> D["Year-by-Year Projection     "] --> E["Millionaire Calculator     "]

    style A fill:#E3F2FD,color:#1565C0,stroke:#90CAF9,stroke-width:2px
    style B fill:#F5F5F5,color:#424242,stroke:#BDBDBD,stroke-width:2px
    style C fill:#FFF3E0,color:#E65100,stroke:#FFCC80,stroke-width:2px
    style D fill:#E8F5E9,color:#2E7D32,stroke:#A5D6A7,stroke-width:2px
    style E fill:#E8F5E9,color:#2E7D32,stroke:#A5D6A7,stroke-width:2px
```

::: {.chart-note .teal}
**åŠŸèƒ½èªªæ˜ï¼š** ä¸‰ç¨®æ¨¡å¼ â€” (1) é€å¹´åŸºé‡‘é æ¸¬ï¼ˆæœˆè¤‡åˆ©ï¼‰ï¼Œ(2) ç™¾è¬å¯Œç¿è¨ˆç®—å™¨ï¼ˆå¤šå°‘å¹´é”åˆ° $1Mï¼‰ï¼Œ(3) åˆ©ç‡æ¯”è¼ƒè¡¨ï¼ˆ1-30% å¹´åˆ©ç‡ï¼‰ã€‚ä¾‹ï¼š$500/æœˆã€10% å¹´åˆ©ç‡ã€30 å¹´ â†’ **$1.14M**ã€‚
:::

```python
# Year-by-year retirement fund projection
def calculate_fund(monthly, rate, years):
    balance = 0
    monthly_rate = rate / 12
    for year in range(1, years + 1):
        for month in range(12):
            balance += monthly
            balance *= (1 + monthly_rate)
        print(f"Year {year:3d}: ${balance:>12,.2f}")
    return balance

# Millionaire Calculator
def years_to_million(monthly, rate):
    balance, months = 0, 0
    monthly_rate = rate / 12
    while balance < 1_000_000:
        balance += monthly
        balance *= (1 + monthly_rate)
        months += 1
    return months // 12, months % 12
```

```{r lab2-compound, echo=FALSE, fig.width=7, fig.height=4}
years <- 1:30
balance <- numeric(30)
monthly <- 500
rate <- 0.10
bal <- 0
for (y in years) {
  for (m in 1:12) {
    bal <- (bal + monthly) * (1 + rate / 12)
  }
  balance[y] <- bal
}

df_ret <- data.frame(year = years, balance = balance / 1000)

ggplot(df_ret, aes(x = year, y = balance)) +
  geom_area(fill = c1, alpha = 0.3) +
  geom_line(colour = c1, linewidth = 1.5) +
  geom_hline(yintercept = 1000, linetype = "dashed", colour = acc, linewidth = 0.8) +
  annotate("text", x = 5, y = 1050, label = "$1M milestone",
           colour = acc, size = 3.5, hjust = 0, fontface = "bold") +
  geom_point(data = df_ret[which.min(abs(df_ret$balance - 1000)), ],
             aes(x = year, y = balance), colour = acc, size = 4, shape = 18) +
  scale_y_continuous(labels = function(x) paste0("$", x, "K")) +
  labs(title = "Retirement Fund Growth ($500/mo, 10% annual return)",
       x = "Year", y = "Balance") +
  theme1()
```

::: {.chart-note .orange}
**è¤‡åˆ©æ•ˆæœï¼š** å‰ 15 å¹´æˆé•·ç·©æ…¢ï¼Œå¾Œ 15 å¹´æŒ‡æ•¸åŠ é€Ÿã€‚$500/æœˆåœ¨ 10% å¹´åˆ©ç‡ä¸‹ç´„ **21 å¹´**é”åˆ°ç™¾è¬ç¾å…ƒï¼ˆ<span style="color:#E65100;">æ©˜è‰²è±å½¢</span>ï¼‰ã€‚è¤‡åˆ©æ˜¯é•·æœŸæŠ•è³‡çš„æ ¸å¿ƒé©…å‹•åŠ›ã€‚
:::

---

### Lab 3 â€” Gradebook Manager / æˆç¸¾ç®¡ç†ç³»çµ±

**Topic / ä¸»é¡Œï¼š** Interactive student grade management with CRUD operations
äº’å‹•å¼å­¸ç”Ÿæˆç¸¾ç®¡ç†ç³»çµ±ï¼Œæ”¯æ´æ–°å¢ã€åˆªé™¤ã€ä¿®æ”¹ã€æŸ¥è©¢ã€‚

**Key Concepts / æ ¸å¿ƒæ¦‚å¿µï¼š** Lists, nested data structures, menu-driven programming, input validation

```python
# Menu-driven gradebook
def main_menu():
    while True:
        print("\n1. Add student")
        print("2. Remove student")
        print("3. Modify grade")
        print("4. Display gradebook")
        print("5. Find highest/lowest")
        print("6. Exit")
        choice = input("Select: ")
        # ... handle each option
```

::: {.chart-note .grey}
**è¨­è¨ˆé‡é»ï¼š** ä½¿ç”¨å·¢ç‹€ list å„²å­˜å­¸ç”Ÿè³‡æ–™ `[name, grade]`ï¼Œæ­é… while loop å¯¦ç¾æŒçºŒäº’å‹•é¸å–®ã€‚åŒ…å«è¼¸å…¥é©—è­‰ï¼ˆæˆç¸¾ç¯„åœ 0-100ï¼‰èˆ‡éŒ¯èª¤è™•ç†ã€‚
:::

---

### Lab 4 â€” Modules, Functions & OOP / æ¨¡çµ„åŒ–ç¨‹å¼è¨­è¨ˆèˆ‡ OOP

**Topic / ä¸»é¡Œï¼š** Modular programming, reusable modules, and object-oriented design
æ¨¡çµ„åŒ–ç¨‹å¼è¨­è¨ˆã€å¯é‡ç”¨æ¨¡çµ„èˆ‡ç‰©ä»¶å°å‘è¨­è¨ˆã€‚

**Key Concepts / æ ¸å¿ƒæ¦‚å¿µï¼š** Module imports, OOP (classes), CSV I/O, distance calculations

```{mermaid}
%%{init: {"theme": "base", "themeVariables": {"fontSize": "18px"}, "flowchart": {"padding": 35}}}%%
flowchart TD
    A["Lab 4 Modules     "] --> B["(a) CSV Field Counter     "]
    A --> C["(b) Parcel Tax Calculator     "]
    A --> D["(c) Distance Calculator     "]

    B --> B1["mycount.py + callingscript.py     "]
    C --> C1["parcelclass.py â†’ OOP     "]
    D --> D1["Euclidean + Great Circle     "]

    style A fill:#E3F2FD,color:#1565C0,stroke:#90CAF9,stroke-width:2px
    style B fill:#FFF3E0,color:#E65100,stroke:#FFCC80,stroke-width:2px
    style C fill:#E8F5E9,color:#2E7D32,stroke:#A5D6A7,stroke-width:2px
    style D fill:#F3E5F5,color:#6A1B9A,stroke:#CE93D8,stroke-width:2px
    style B1 fill:#F5F5F5,color:#424242,stroke:#BDBDBD,stroke-width:2px
    style C1 fill:#F5F5F5,color:#424242,stroke:#BDBDBD,stroke-width:2px
    style D1 fill:#F5F5F5,color:#424242,stroke:#BDBDBD,stroke-width:2px
```

```python
# (b) Parcel class with tax assessment
class Parcel:
    def __init__(self, parcel_id, land_use, market_value):
        self.parcel_id = parcel_id
        self.land_use = land_use
        self.market_value = market_value

    def assess_tax(self):
        rates = {"SFR": 0.05, "MFR": 0.04}
        rate = rates.get(self.land_use, 0.02)
        return self.market_value * rate

# (c) Great Circle Distance (Haversine formula)
import math
def great_circle(lat1, lon1, lat2, lon2):
    R = 6371  # Earth radius in km
    dlat = math.radians(lat2 - lat1)
    dlon = math.radians(lon2 - lon1)
    a = (math.sin(dlat/2)**2 +
         math.cos(math.radians(lat1)) *
         math.cos(math.radians(lat2)) *
         math.sin(dlon/2)**2)
    return R * 2 * math.asin(math.sqrt(a))
```

::: {.chart-note .teal}
**ä¸‰å€‹å­ä»»å‹™ï¼š** (a) è¨ˆç®— CSV å„æ¬„ä½ç©ºå€¼æ•¸é‡ï¼Œ(b) ä»¥ OOP å»ºç«‹ Parcel é¡åˆ¥è¨ˆç®—ä¸å‹•ç”¢ç¨…ï¼ˆSFR 5%ã€MFR 4%ã€å…¶ä»– 2%ï¼‰ï¼Œ(c) ä»¥ Haversine å…¬å¼è¨ˆç®—åœ°çƒè¡¨é¢å…©é»è·é›¢ã€‚
:::

---

### Lab 5 â€” Pandas Data Analysis / Pandas è³‡æ–™åˆ†æ

**Topic / ä¸»é¡Œï¼š** DataFrame manipulation, grouping, pivoting, and multi-dataset merging
Pandas DataFrame æ“ä½œã€åˆ†çµ„ã€æ¨ç´åˆ†æèˆ‡å¤šè³‡æ–™é›†åˆä½µã€‚

**Datasets / è³‡æ–™é›†ï¼š** MovieLens (100K ratings), COVID-19 global time series

**Key Concepts / æ ¸å¿ƒæ¦‚å¿µï¼š** pandas Series/DataFrame, boolean indexing, GroupBy, pivot tables, merge/join

```python
# COVID-19 fatality rate analysis
fatality = (deaths_total / confirmed_total * 100).sort_values(ascending=False)
# Peru: 9.17%, Mexico: 7.58%, South Africa: 2.68%

# MovieLens: most rated movies
top_movies = ratings.groupby('movieId').size().sort_values(ascending=False).head(10)

# Multi-DataFrame merge
merged = pd.merge(users, ratings, on='userId')
merged = pd.merge(merged, movies, on='movieId')
```

::: {.chart-note .orange}
**åˆ†æé‡é»ï¼š** (1) MovieLens â€” æ‰¾å‡ºè©•åˆ†æœ€å¤šçš„é›»å½±ã€ç”·å¥³è©•åˆ†å·®ç•°æœ€å¤§çš„é›»å½±ï¼Œ(2) COVID-19 â€” ç¢ºè¨ºæ•¸å‰ 25 åœ‹ã€å„åœ‹è‡´æ­»ç‡æ’åï¼ˆç§˜é­¯ 9.17% æœ€é«˜ï¼‰ã€æœˆåº¦å¢é‡åˆ†æï¼ˆç¾åœ‹ 2021 å¹´ 9 æœˆå¢ +430 è¬ä¾‹ï¼‰ã€‚
:::

---

### Lab 6 â€” Data Visualization / è³‡æ–™è¦–è¦ºåŒ–

**Topic / ä¸»é¡Œï¼š** Publication-quality charts with matplotlib and Altair
ä½¿ç”¨ matplotlib èˆ‡ Altair è£½ä½œå‡ºç‰ˆå“è³ªçš„åœ–è¡¨èˆ‡äº’å‹•å¼è¦–è¦ºåŒ–ã€‚

**Datasets / è³‡æ–™é›†ï¼š** MovieLens, COVID-19, Seattle weather (Vega)

::: {layout-ncol=2}
![Top 10 Most-Reviewed Movies](gis_lab6_barh_top10_movies.png)

![COVID-19 Top 25 Countries](gis_lab6_bar_covid_top25.png)
:::

::: {layout-ncol=2}
![Gender Rating Differences](gis_lab6_scatter_gender_rating_diff.png)

![Seattle Weather Distribution](gis_lab6_pie_seattle_weather.png)
:::

::: {.chart-note .teal}
**è¦–è¦ºåŒ–æŠ€å·§ï¼š** æ°´å¹³é•·æ¢åœ–æ¯”è¼ƒé›»å½±è©•è«–æ•¸é‡ã€æ•£é»åœ–å‘ˆç¾ç”·å¥³è©•åˆ†å·®ç•°ã€åœ“é¤…åœ–å±•ç¤ºå¤©æ°£é¡å‹åˆ†å¸ƒã€æŠ˜ç·šåœ–è¿½è¹¤ COVID-19 è¶¨å‹¢ã€‚Altair éƒ¨åˆ†è£½ä½œäº†äº’å‹•å¼ linked chartï¼ˆé»é¸åœ‹å®¶ â†’ é¡¯ç¤ºè©²åœ‹æ­»äº¡è¶¨å‹¢ï¼‰ã€‚
:::

---

### Lab 7 â€” GUI Development with PyQt5 / PyQt5 æ¡Œé¢æ‡‰ç”¨ç¨‹å¼

**Topic / ä¸»é¡Œï¼š** Desktop application: Number guessing game with graphical interface
ä½¿ç”¨ PyQt5 é–‹ç™¼æ•¸å­—çŒœè¬éŠæˆ²æ¡Œé¢æ‡‰ç”¨ç¨‹å¼ã€‚

**Key Concepts / æ ¸å¿ƒæ¦‚å¿µï¼š** PyQt5 widgets, event-driven programming, signal/slot, Qt Designer

```{mermaid}
%%{init: {"theme": "base", "themeVariables": {"fontSize": "18px"}, "flowchart": {"padding": 35}}}%%
flowchart LR
    A["Qt Designer     "] --> B["frmGuess.py     "] --> C["lab7.py     "] --> D["Number Game GUI     "]

    style A fill:#F5F5F5,color:#424242,stroke:#BDBDBD,stroke-width:2px
    style B fill:#E3F2FD,color:#1565C0,stroke:#90CAF9,stroke-width:2px
    style C fill:#FFF3E0,color:#E65100,stroke:#FFCC80,stroke-width:2px
    style D fill:#E8F5E9,color:#2E7D32,stroke:#A5D6A7,stroke-width:2px
```

```python
# Number guessing game with hint system
class GuessGame:
    def __init__(self):
        self.target = random.randint(1, 100)
        self.guesses = 0

    def make_guess(self, n):
        self.guesses += 1
        if n == self.target:
            return "Correct!"
        return "Higher!" if n < self.target else "Lower!"

    def use_hint(self):
        """Costs 5 guesses, reveals number within Â±5"""
        self.guesses += 5
        return (self.target - 5, self.target + 5)
```

::: {.chart-note .grey}
**GUI åŠŸèƒ½ï¼š** éš¨æ©Ÿæ•¸å­— (1-100) çŒœè¬éŠæˆ²ã€‚åŒ…å« (1) çŒœæ¸¬è¿½è¹¤ï¼Œ(2) æç¤ºç³»çµ±ï¼ˆæ¶ˆè€— 5 æ¬¡æ©Ÿæœƒï¼Œç¸®å°ç¯„åœåˆ° Â±5ï¼‰ï¼Œ(3) å‹åˆ©åµæ¸¬èˆ‡é‡è¨­ã€‚ä½¿ç”¨ Qt Designer è¨­è¨ˆä»‹é¢ï¼Œ`frmGuess.py` ç‚ºè‡ªå‹•ç”Ÿæˆçš„ UI ç¨‹å¼ç¢¼ã€‚
:::

---

### Lab 8 â€” ArcGIS API for Python / ArcGIS Python API

**Topic / ä¸»é¡Œï¼š** Programmatic map creation and spatial data querying with ArcGIS Online
ä½¿ç”¨ ArcGIS API ç¨‹å¼åŒ–å»ºç«‹åœ°åœ–èˆ‡æŸ¥è©¢ç©ºé–“è³‡æ–™ã€‚

**Key Concepts / æ ¸å¿ƒæ¦‚å¿µï¼š** ArcGIS authentication, WebMap, FeatureLayer queries, basemap cycling

```python
from arcgis.gis import GIS
from arcgis.mapping import WebMap

gis = GIS("https://www.arcgis.com", username, password)
m = gis.map("University of Texas at Dallas", zoomlevel=15)

# Search and add feature layers
items = gis.content.search("UTD Buildings", item_type="Feature Layer")
m.add_layer(items[0])

# Query building attributes
fl = items[0].layers[0]
fl.properties.fields  # Inspect field schema
```

::: {.chart-note .teal}
**GIS æ“ä½œï¼š** é€é Python API é€£æ¥ ArcGIS Onlineï¼Œä»¥ UTD æ ¡åœ’ç‚ºä¸­å¿ƒå»ºç«‹äº’å‹•å¼åœ°åœ–ï¼Œæœå°‹ä¸¦ç–ŠåŠ å»ºç¯‰ç‰©åœ–å±¤ï¼ŒæŸ¥è©¢å±¬æ€§æ¬„ä½çµæ§‹ï¼Œåˆ‡æ›ä¸åŒåº•åœ–æ¨£å¼ã€‚
:::

---

### Lab 10 â€” Web Scraping & APIs / ç¶²é çˆ¬èŸ²èˆ‡ API

**Topic / ä¸»é¡Œï¼š** Data extraction from web sources using APIs and scraping tools
ä½¿ç”¨ API èˆ‡çˆ¬èŸ²å·¥å…·å¾ç¶²é ä¾†æºæ“·å–è³‡æ–™ã€‚

**Key Concepts / æ ¸å¿ƒæ¦‚å¿µï¼š** requests, JSON parsing, BeautifulSoup (HTML), Selenium (dynamic content)

```{mermaid}
%%{init: {"theme": "base", "themeVariables": {"fontSize": "18px"}, "flowchart": {"padding": 35}}}%%
flowchart LR
    A["requests GET     "] --> B["JSON / HTML     "]
    B --> C["BeautifulSoup     "]
    B --> D["json.loads()     "]
    C --> E["Structured Data     "]
    D --> E

    style A fill:#E3F2FD,color:#1565C0,stroke:#90CAF9,stroke-width:2px
    style B fill:#F5F5F5,color:#424242,stroke:#BDBDBD,stroke-width:2px
    style C fill:#FFF3E0,color:#E65100,stroke:#FFCC80,stroke-width:2px
    style D fill:#E8F5E9,color:#2E7D32,stroke:#A5D6A7,stroke-width:2px
    style E fill:#E8F5E9,color:#2E7D32,stroke:#A5D6A7,stroke-width:2px
```

```python
import requests
from bs4 import BeautifulSoup

# RESTful API request
response = requests.get("https://api.example.com/data")
data = response.json()

# HTML scraping
page = requests.get("https://example.com")
soup = BeautifulSoup(page.content, "html.parser")
elements = soup.find_all("div", class_="target")
```

::: {.chart-note .grey}
**å…©ç¨®æ–¹æ³•ï¼š** (1) RESTful API â€” ç™¼é€ GET/POST è«‹æ±‚ï¼Œè§£æ JSON å›æ‡‰ï¼Œ(2) HTML çˆ¬èŸ² â€” ä½¿ç”¨ BeautifulSoup è§£æ DOM çµæ§‹ï¼ŒSelenium è™•ç†å‹•æ…‹è¼‰å…¥å…§å®¹ã€‚
:::

---

### Lab 11 â€” Regular Expressions & GeoPandas / æ­£è¦è¡¨é”å¼èˆ‡åœ°ç†ç©ºé–“è¦–è¦ºåŒ–

**Topic / ä¸»é¡Œï¼š** Parse structured text files with regex, create spatial visualizations with GeoPandas
ä½¿ç”¨æ­£è¦è¡¨é”å¼è§£æçµæ§‹åŒ–æ–‡å­—ï¼Œæ­é… GeoPandas è£½ä½œåœ°ç†ç©ºé–“è¦–è¦ºåŒ–ã€‚

**Dataset / è³‡æ–™é›†ï¼š** `worldcities.txt` â€” city coordinates in degrees-minutes format

```python
import re
import geopandas as gpd
from shapely.geometry import Point

# Parse DMS coordinates with regex
pattern = r"^(.*)\t(\d+)\t(\d+) ([NS])\t(\d+)\t(\d+) ([EW])\t(.*)$"

for line in open("worldcities.txt"):
    match = re.match(pattern, line.strip())
    if match:
        city, lat_d, lat_m, ns, lon_d, lon_m, ew, country = match.groups()
        lat = (int(lat_d) + int(lat_m)/60) * (-1 if ns == 'S' else 1)
        lon = (int(lon_d) + int(lon_m)/60) * (-1 if ew == 'W' else 1)
```

![World Cities Map â€” GeoPandas with Natural Earth basemap](gis_lab11_worldcities_map.png){width="80%"}

::: {.chart-note .teal}
**è™•ç†æµç¨‹ï¼š** Regex å¾ `worldcities.txt` æ“·å–åŸå¸‚åã€ç¶“ç·¯åº¦ï¼ˆåº¦åˆ†æ ¼å¼ï¼‰èˆ‡åœ‹å®¶ â†’ è½‰æ› DMS ç‚ºåé€²ä½åº¦æ•¸ â†’ å»ºç«‹ Shapely Point å¹¾ä½• â†’ GeoPandas GeoDataFrame â†’ ç–ŠåŠ  Natural Earth åº•åœ–ç¹ªè£½å…¨çƒåŸå¸‚åˆ†å¸ƒåœ–ã€‚
:::

---

## Midterm / æœŸä¸­è€ƒ {#midterm}

### Midterm Project â€” Data Analysis Suite / è³‡æ–™åˆ†æçµ„åˆ

ä¸‰å€‹ç¨ç«‹çš„ Python ç¨‹å¼ï¼Œå±•ç¤ºæª”æ¡ˆæ“ä½œã€è³‡æ–™åˆ†æèˆ‡ä¸å‹•ç”¢æŸ¥è©¢èƒ½åŠ›ã€‚

```{mermaid}
%%{init: {"theme": "base", "themeVariables": {"fontSize": "18px"}, "flowchart": {"padding": 35}}}%%
flowchart TD
    A["Midterm Project     "] --> B["Alumni Research     "]
    A --> C["File Manipulation     "]
    A --> D["Real Estate Search     "]

    B --> B1["Income & Debt by Major     "]
    C --> C1["Recursive CSV Processing     "]
    D --> D1["Multi-criteria Property Filter     "]

    style A fill:#E3F2FD,color:#1565C0,stroke:#90CAF9,stroke-width:2px
    style B fill:#FFF3E0,color:#E65100,stroke:#FFCC80,stroke-width:2px
    style C fill:#E8F5E9,color:#2E7D32,stroke:#A5D6A7,stroke-width:2px
    style D fill:#F3E5F5,color:#6A1B9A,stroke:#CE93D8,stroke-width:2px
    style B1 fill:#F5F5F5,color:#424242,stroke:#BDBDBD,stroke-width:2px
    style C1 fill:#F5F5F5,color:#424242,stroke:#BDBDBD,stroke-width:2px
    style D1 fill:#F5F5F5,color:#424242,stroke:#BDBDBD,stroke-width:2px
```

#### 1. Alumni Research / æ ¡å‹ç ”ç©¶

åˆ†ææ ¡å‹æ”¶å…¥èˆ‡å­¸è²¸ï¼šæŒ‰ç§‘ç³»çµ±è¨ˆå¹³å‡å¹´é½¡ã€æ€§åˆ¥æ¯”ä¾‹ã€æ”¶å…¥æ’åã€å­¸è²¸é‚„æ¬¾è¨ˆç®—å™¨ï¼ˆä»¥å¹´æ”¶å…¥ 5% ç‚ºæœˆé‚„æ¬¾ï¼‰ã€‚

```python
# Loan payoff calculator: 5% annual income as monthly payment
def loan_payoff(debt, annual_income, interest_rate=0.05):
    monthly_payment = annual_income * 0.05 / 12
    balance, months = debt, 0
    while balance > 0:
        balance *= (1 + interest_rate / 12)
        balance -= monthly_payment
        months += 1
    return months // 12, months % 12
```

#### 2. File Manipulation / æª”æ¡ˆæ“ä½œ

éè¿´èµ°è¨ªç›®éŒ„ï¼Œåµæ¸¬ CSV æª”æ¡ˆä¸¦ä»¥ tab åˆ†éš”æ ¼å¼ç¾åŒ–è¼¸å‡ºã€‚

```python
import os
def process_directory(path):
    if os.path.isfile(path) and path.endswith('.csv'):
        pretty_print_csv(path)
    elif os.path.isdir(path):
        for root, dirs, files in os.walk(path):
            for f in files:
                if f.endswith('.csv'):
                    pretty_print_csv(os.path.join(root, f))
```

#### 3. Real Estate Search / ä¸å‹•ç”¢æœå°‹

å¤šæ¢ä»¶éæ¿¾åœ°ç”¢ï¼šå·åˆ¥ä»£ç¢¼ã€æœ€å°å±…ä½é¢ç©ã€å¸‚åƒ¹ç¯„åœã€æŒ‡å®šå­¸å€ã€‚

::: {.chart-note .orange}
**æœŸä¸­ç¸½çµï¼š** ä¸‰å€‹ç¨‹å¼åˆ†åˆ¥å±•ç¤º (1) pandas è³‡æ–™åˆ†æèˆ‡åˆä½µï¼ˆ`merge on ID`ï¼‰ï¼Œ(2) `os.walk()` éè¿´æª”æ¡ˆè™•ç†ï¼Œ(3) å¤šæ¢ä»¶é‚è¼¯ç¯©é¸ã€‚æ¶µè“‹è³‡æ–™ç§‘å­¸ã€ç³»çµ±æ“ä½œèˆ‡å¯¦å‹™æ‡‰ç”¨ä¸‰å¤§é¢å‘ã€‚
:::

---

## Final Project / æœŸæœ«å°ˆæ¡ˆ {#final-project}

### SVD Image Compression Application / SVD å½±åƒå£“ç¸®æ‡‰ç”¨ç¨‹å¼

**Task / ä»»å‹™ï¼š** Build an interactive desktop application for image compression using Singular Value Decomposition (SVD), with real-time preview and quality metrics.
å»ºç«‹äº’å‹•å¼æ¡Œé¢æ‡‰ç”¨ç¨‹å¼ï¼Œä½¿ç”¨å¥‡ç•°å€¼åˆ†è§£ (SVD) é€²è¡Œå½±åƒå£“ç¸®ï¼Œå…·å‚™å³æ™‚é è¦½èˆ‡å“è³ªæŒ‡æ¨™ã€‚

**Method / æ–¹æ³•ï¼š** PyQt6 GUI + NumPy SVD + PIL image processing

**Mathematical Foundation / æ•¸å­¸åŸºç¤ï¼š** Eckart-Young Theorem â€” A_k = sum(sigma_i * u_i * v_i^T) for i=1 to k

#### Application Architecture / æ‡‰ç”¨ç¨‹å¼æ¶æ§‹

```{mermaid}
%%{init: {"theme": "base", "themeVariables": {"fontSize": "18px"}, "flowchart": {"padding": 35}}}%%
flowchart TD
    A["Image Input (drag & drop)     "] --> B["RGB Channel Split     "]
    B --> C["np.linalg.svd per channel     "]
    C --> D["Low-rank Approximation A_k     "]
    D --> E["Reconstruct RGB     "]
    E --> F["PSNR + File Size     "]
    F --> G["Preview & Export     "]

    style A fill:#E3F2FD,color:#1565C0,stroke:#90CAF9,stroke-width:2px
    style B fill:#E3F2FD,color:#1565C0,stroke:#90CAF9,stroke-width:2px
    style C fill:#FFF3E0,color:#E65100,stroke:#FFCC80,stroke-width:2px
    style D fill:#FFF3E0,color:#E65100,stroke:#FFCC80,stroke-width:2px
    style E fill:#E8F5E9,color:#2E7D32,stroke:#A5D6A7,stroke-width:2px
    style F fill:#F3E5F5,color:#6A1B9A,stroke:#CE93D8,stroke-width:2px
    style G fill:#E8F5E9,color:#2E7D32,stroke:#A5D6A7,stroke-width:2px
```

::: {.chart-note .teal}
**SVD åŸç†ï¼š** ä»»ä½•çŸ©é™£ A å¯åˆ†è§£ç‚º A = U Sigma V^Tã€‚å–å‰ k å€‹å¥‡ç•°å€¼é‡å»º A_kï¼Œå³ç‚ºæœ€ä½³ rank-k è¿‘ä¼¼ï¼ˆEckart-Young å®šç†ï¼‰ã€‚k è¶Šå°å£“ç¸®ç‡è¶Šé«˜ï¼Œä½†å“è³ªè¶Šä½ã€‚
:::

#### Core Algorithm / æ ¸å¿ƒæ¼”ç®—æ³•

```python
import numpy as np
from PIL import Image

def perform_svd(image_array):
    """SVD on each RGB channel separately"""
    channels = {}
    for i, name in enumerate(['R', 'G', 'B']):
        U, S, Vt = np.linalg.svd(image_array[:, :, i], full_matrices=False)
        channels[name] = (U, S, Vt)
    return channels

def reconstruct(channels, k):
    """Low-rank approximation with k singular values"""
    reconstructed = np.zeros_like(original)
    for i, name in enumerate(['R', 'G', 'B']):
        U, S, Vt = channels[name]
        reconstructed[:, :, i] = np.clip(
            U[:, :k] @ np.diag(S[:k]) @ Vt[:k, :], 0, 255
        )
    return reconstructed.astype(np.uint8)

def calculate_psnr(original, compressed):
    mse = np.mean((original.astype(float) - compressed.astype(float)) ** 2)
    return 10 * np.log10(255**2 / mse) if mse > 0 else float('inf')
```

#### GUI Features / ä»‹é¢åŠŸèƒ½

```python
# PyQt6 GUI with dual slider control
class SVDCompressor(QMainWindow):
    def __init__(self):
        # Drag-and-drop image upload
        # Dual slider: compression ratio â†” target file size (linked)
        # Smart presets:
        #   Social media: 2 MB, ~35 dB PSNR
        #   Email:        5 MB, ~40 dB PSNR
        #   High quality: 80% compression, ~45 dB PSNR
        pass
```

#### Application Demo / æ‡‰ç”¨ç¨‹å¼å±•ç¤º

![SVD Compression App â€” PyQt6 Desktop Application](gis_svd_app_screenshot.png){width="80%"}

::: {.chart-note .orange}
**App åŠŸèƒ½ä¸€è¦½ï¼š**

- **æ‹–æ›³ä¸Šå‚³** â€” å°‡åœ–ç‰‡æ‹–ç§»è‡³ä»‹é¢å³å¯è¼‰å…¥
- **é›™æ»‘æ¡¿é€£å‹•** â€” å£“ç¸®æ¯”ä¾‹ â†” ç›®æ¨™æª”æ¡ˆå¤§å°ï¼ˆæ‹–å‹•ä¸€æ¢å¦ä¸€æ¢è‡ªå‹•èª¿æ•´ï¼‰
- **æ™ºæ…§å»ºè­°** â€” ä¸‰ç¨®é è¨­æ¨¡æ¿ï¼šç¤¾ç¾¤åª’é«” (2 MB)ã€éƒµä»¶é™„ä»¶ (5 MB)ã€é«˜å“è³ªå­˜æª” (PSNR > 40 dB)
- **å³æ™‚é è¦½** â€” å·¦å³å°æ¯”åŸåœ– vs å£“ç¸®å¾Œï¼Œä¸‹æ–¹é¡¯ç¤º PSNR / æª”æ¡ˆå¤§å° / å£“ç¸®æ¯”
- **å“è³ªè­¦å‘Š** â€” PSNR ä½æ–¼ 40 dB æ™‚è‡ªå‹•å½ˆå‡ºè­¦å‘Š
- **åŸºæ–¼ Eckart-Young å®šç†** â€” ç†è«–ä¿è­‰æœ€ä½³ä½ç§©è¿‘ä¼¼
:::

ğŸ“ **Downloadï¼š** [SVD_app.py (åŸå§‹ç¢¼)](SVD_app.py)

#### SVD Quality Analysis / SVD å“è³ªåˆ†æ

::: {layout-ncol=2}
![RGB Channel Decomposition](gis_svd_rgb_channels.png)

![SVD Metrics vs k (MSE, PSNR, norm, sigma)](gis_svd_metrics_vs_k.png)
:::

```{r svd-psnr, echo=FALSE, fig.width=8, fig.height=4}
k_vals <- c(1, 10, 50, 100, 200, 300, 500, 700)
psnr_vals <- c(12.5, 20.3, 27.1, 29.5, 31.0, 31.88, 38.2, 44.70)
mse_vals  <- c(3650, 605, 127, 73, 51.6, 42.29, 9.8, 2.2)

df_svd <- data.frame(k = k_vals, psnr = psnr_vals, mse = mse_vals)

p1 <- ggplot(df_svd, aes(x = k, y = psnr)) +
  geom_line(colour = c1, linewidth = 1.5) +
  geom_point(colour = c1, size = 3) +
  geom_hline(yintercept = 30, linetype = "dashed", colour = c3, linewidth = 0.8) +
  annotate("text", x = 50, y = 31, label = "30 dB (good quality)",
           colour = c3, size = 3.2, hjust = 0) +
  geom_point(data = df_svd[df_svd$k == 300, ], colour = acc, size = 5, shape = 18) +
  annotate("label", x = 300, y = 34,
           label = "k=300: 31.88 dB", colour = acc, size = 3,
           fontface = "bold", fill = "white", label.size = 0) +
  labs(title = "PSNR vs Singular Values (k)", x = "k", y = "PSNR (dB)") +
  theme1()

p2 <- ggplot(df_svd, aes(x = k, y = mse)) +
  geom_line(colour = c2, linewidth = 1.5) +
  geom_point(colour = c2, size = 3) +
  scale_y_log10() +
  labs(title = "MSE vs Singular Values (k)", x = "k", y = "MSE (log scale)") +
  theme1()

grid.arrange(p1, p2, ncol = 2,
             top = grid::textGrob("SVD Image Compression â€” Quality vs Compression Level",
                                  gp = grid::gpar(fontface = "bold", fontsize = 13)))
```

::: {.chart-note .pink}
**å“è³ªåˆ†æï¼š** å·¦åœ– â€” PSNR éš¨ k å¢åŠ è€Œæå‡ï¼Œk=300 æ™‚é” **31.88 dB**ï¼ˆè¶…é 30 dB é–€æª»ï¼Œ<span style="color:#7A7A7A;">ç°è‰²è™›ç·š</span>ï¼‰ï¼Œk=700 æ™‚æ¥è¿‘åŸåœ–å“è³ª (44.70 dB)ã€‚å³åœ– â€” MSE å‘ˆæŒ‡æ•¸ä¸‹é™ï¼Œk=300 å¾Œæ”¹å–„è¶¨ç·©ã€‚**å¯¦å‹™çµè«–ï¼š** k=200~400 æ˜¯å£“ç¸®ç‡èˆ‡å“è³ªçš„æœ€ä½³å¹³è¡¡å€é–“ã€‚
:::

| k | PSNR (dB) | MSE | Compression Ratio |
|---|-----------|-----|-------------------|
| 1 | 12.50 | 3650 | 99.9% |
| 50 | 27.10 | 127 | 95.1% |
| 100 | 29.50 | 73 | 90.3% |
| **300** | **31.88** | **42.29** | **70.9%** |
| 700 | 44.70 | 2.2 | 32.0% |

::: {.chart-note .orange}
**Eckart-Young å®šç†é©—è­‰ï¼š** å¯¦é©—ç¢ºèª ||A - A_k||â‚‚ â‰ˆ sigma_{k+1}ï¼Œå³ä½ç§©è¿‘ä¼¼çš„èª¤å·®ç­‰æ–¼ç¬¬ k+1 å€‹å¥‡ç•°å€¼ã€‚é€™ç‚ºé¸æ“‡æœ€ä½³ k å€¼æä¾›äº†ç†è«–ä¾æ“š â€” ç•¶ sigma_{k+1} å°æ–¼å“è³ªé–€æª»æ™‚å³å¯åœæ­¢ã€‚
:::

---

## Course Skills Summary / èª²ç¨‹æŠ€èƒ½ç¸½è¦½

```{r skills-summary, echo=FALSE, fig.width=8, fig.height=4.5}
df_skills <- data.frame(
  category = factor(
    c("Core Python", "Data Science", "GIS & Spatial", "GUI Dev", "Web & APIs", "Math & Algorithms"),
    levels = c("Math & Algorithms", "Web & APIs", "GUI Dev", "GIS & Spatial", "Data Science", "Core Python")
  ),
  labs = c(6, 4, 3, 2, 2, 2),
  tools = c(
    "Functions, OOP\nFile I/O, Regex",
    "pandas, NumPy\nmatplotlib, Altair",
    "ArcGIS API\nGeoPandas, Shapely",
    "PyQt5/6\nQt Designer",
    "requests, BS4\nSelenium, JSON",
    "SVD, Haversine\nPSNR, MSE"
  )
)

ggplot(df_skills, aes(x = labs, y = category, fill = category)) +
  geom_col(colour = c4, width = 0.6) +
  geom_text(aes(label = tools), hjust = -0.05, size = 2.8, colour = c4, lineheight = 0.9) +
  scale_fill_manual(values = c(c1, c2, "#FF9800", "#9C27B0", "#4CAF50", c3)) +
  scale_x_continuous(limits = c(0, 12), expand = c(0, 0)) +
  labs(title = "GIS & Python â€” Skills Coverage Across Labs",
       x = "Number of Labs", y = NULL) +
  theme1() +
  theme(legend.position = "none")
```

::: {.chart-note .teal}
**èª²ç¨‹ç¸½çµï¼š** å¾åŸºç¤ Pythonï¼ˆå‡½å¼ã€OOPã€æª”æ¡ˆæ“ä½œï¼‰åˆ°è³‡æ–™ç§‘å­¸ï¼ˆpandasã€è¦–è¦ºåŒ–ï¼‰ã€GIS ç©ºé–“åˆ†æï¼ˆArcGISã€GeoPandasï¼‰ã€GUI é–‹ç™¼ï¼ˆPyQt5/6ï¼‰ã€ç¶²é çˆ¬èŸ²ï¼ˆrequestsã€BeautifulSoupï¼‰ï¼Œæœ€çµ‚ä»¥ SVD å½±åƒå£“ç¸®å°ˆæ¡ˆæ•´åˆæ•¸å­¸ç†è«–èˆ‡è»Ÿé«”å·¥ç¨‹èƒ½åŠ›ã€‚
:::
